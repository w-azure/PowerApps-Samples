# Use metadata to generate entity diagrams

Visual representation of metadata can be very useful, especially when describing the relationship between entities in the system. You can use the Metadata Diagram application to generate entity relationship diagrams. You can create a simple diagram that shows a relationship for just one entity or a more complex diagram that includes dozens of related entities, including custom and system entities.

## What this sample does

This sample application generates an entity relationship diagram for one or more enities specified as command arguments. The output is a file in the Microsoft Visio format.

The following entity diagram was generated using the compiled Metadata Diagram application. The diagram shows the relationship between the `account` entity, the `contact` entity, and other entities in the system. The names shown are the logical entity names. If there are multiple relationships between the same two entities, only one line is drawn in the diagram for simplicity.

:::image type="content" source="entity-diagram.png" alt-text="Screenshot of the entity diagram generated by this sample.":::

> [!TIP]
> Always specify one or more entites as command line arguments. Specifying no entities results in a diagram of all entities in the target environment. The resulting diagram takes a long time to generate and is too complex to be useful. Specifying fewer entities in the diagram produces better results.

## Prerequisites

1. Download and install Microsoft Visio. A trial installation should be sufficient.
1. Launch the Visual Studio 2022 (or later) installer to verify that the **Visual Studio Tools for Office** component is installed or install it. You can also download [Visual Studio 2010 Tools for Office Runtime](https://www.microsoft.com/en-us/download/details.aspx?id=105522.&msockid=0eb330f6bc236d9e21a425cabd0e6c09) manually.

## How to run this sample

You can run the sample in Visual Studio in two different ways with either the default connection string or your own connection string.

## Option 1: Run sample with no code file changes

1. In File Explorer, select the solution (*.sln) file to launch Visual Studio.
1. Add logical entity names as command line arguments in one of two ways:
   1. Add one or more entity names in the project properties form by going to **Project** > **Properties** > **Debug**. For example, you can add`account contact` to the **Command line arguments** field to represent the entities named `account` and `contact`. Use entity names that exist in your test environment.
   1. Alternatively, you can run the compiled program directly from the Command Prompt with a space-separated list of entites to diagram.

      ```cmd
      cd bin/Debug
      GenerateEntityDiagram.exe account contact
      ```

1. If you added entity names to project properties, run the application by choosing `Start` in the Visual Studio toolbar.

1. If you didn't add your own credentials to App.config, you might see a login popup. The popup might only flash open and close, but if it stays open, select a deployment type of **Office 365** and check the **Show Advanced** box. Enter your account user name and password. Select **Login**.

   :::image type="content" source="login-popup.png" alt-text="Screenshot that shows the right options selected or entered in the login popup.":::

## Option 2: Run sample with your own connection string and entities

1. Edit the `App.config` file and uncomment the `<connectionstring/>` code.
1. Replace the `Username` and `Url` values with your Dataverse environment username and service URL. You can also add a `Password=` parameter in the connection string.

   :::image type="content" source="connection-string.png" alt-text="Screenshot that shows the commented out connection string code and where to change the user name and URL.":::

1. Since the environment is changed from the default, you must change the entity names in one of two ways.
   1. You can add your own logical entity names on the command line when you run the application. For example, your command should have this format:

      ```cmd
      GenerateEntityDiagram.exe entity1 entity2
      ```

   1. Alternatively, in Visual Studio, you can add logical entity names to Project Properties by navigating to **Property Pages** > **Debug**. Under **Start options**, add the entity names in the **Command line arguments** field.
   1. Build and run the sample application.

## Results

The first entity name is used to name the generated Visio file. For example, if the first entity name program argument is `account`, you find the generated diagram called `account.vsd` in your `bin/Debug` folder after running the application.

## Related information

- [Use metadata to generate entity diagram](https://learn.microsoft.com/dynamics365/customer-engagement/developer/use-metadata-generate-entity-diagrams)
- [Use connection strings in XRM tooling to connect to Microsoft Dataverse](https://learn.microsoft.com/power-apps/developer/data-platform/xrm-tooling/use-connection-strings-xrm-tooling-connect).
